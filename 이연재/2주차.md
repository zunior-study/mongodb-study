### Q. NoSQL vs RDBMS 장단점

**RDBMS**

RDBMS는 관계형 데이터 모델을 기초로 두고 모든 데이터를 2차원 테이블 형태로 관리합니다. 이렇게 테이블 형태로 관리하는 것은 장단점이 존재합니다.
- **장점**
  - 스키마에 맞춰 데이터를 관리하기 때문에 명확한 데이터 구조와 데이터의 정합성을 보장할 수 있습니다.
- **단점**
  - 시스템이 커질 수록 (Join 문이 많아져) 쿼리가 복잡해질 수 있습니다.
  - 스키마로 인해 데이터가 유연하지 못하고, 스키마를 변경하게 될 경우 복잡해질 수 있습니다.
  - 성능 향상을 위해서는 서버의 성능을 향상 시켜야하는 Scale-up만을 지원합니다.

**NoSQL**

NoSQL은 RDBMS가 Scale-Up으로만 성능이 향상 가능하므로 이를 해결하기 위해 Scale-out을 목표로 등장하였습니다. 
때문에 RDBMS와 달리 테이블 간 관계를 정의하지 않아 스키마에 맞춰 데이터를 관리하지 않고, 이에 관한 장단점을 지니고 있습니다.
- **장점**
  - 스키마가 없기 때문에 유연하고 자유로운 데이터 구조를 가질 수 있다. (언제든 저장된 데이터를 조정하고 새로운 필드를 추가할 수 있다.)
  - 데이터 분산이 용이하며 성능 향상을 위한 Saclue-up과 Scale-out이 가능하다.
- **단점**
  - 데이터 중복이 발생할 수 있으며, 중복된 데이터를 UPDATE 하는 경우 모든 컬렉션에서 수행해야하기 때문에 느리다.
  - 스키마가 존재하지 않기에 명확한 데이터 구조를 보장하지 않으며 데이터 구조 결정이 어려울 수 있다.

<br><br>

### Q. 관계형 데이터베이스에서 NoSQL로 데이터 저장소를 변경할 때 고려해야 할 사항
- **NoSQL 을 선택하는 경우**
    - 대량의 단순 정보를 빠르게 저장하고 조회할 때, 관계형 데이터베이스가 처리하지 못하는 대량의 데이터를 입력할때(보통 수십 기가바이트의 데이터), 스키마가 고정되지 않은 데이터를 저장하고 조회할 때. (관계형 데이터베이스의 특성상 제공 가능한 성능에 한계가 있다. 그 한계를 넘어선 성능이 필요할 때 NoSQL을 선택할 수 있다.)

- **어떤 NoSQL을 사용해야 할지 선택**
    1. **일관성 모델 판단:** 기존 서비스의 일관성 요구 수준을 평가하고, 강한 일관성이 필요한지 느슨한 일관성을 허용해도 되는지 결정해야 합니다.
    2. **데이터 모델 선택:** NoSQL의 다양한 데이터 모델 중에서 제공하려는 기능과 필요에 따라 어떤 모델을 선택할지 고려합니다. 키-값, 문서, 컬럼 패밀리 등의 모델이 있을 수 있습니다.
    3. **읽기/쓰기 성능 고려:** 서비스의 읽기와 쓰기 비율을 분석하여 선택한 NoSQL이 해당 요구에 얼마나 적합한지 평가합니다. 읽기 중심이라면 캐싱 기능이 뛰어난 NoSQL이 적합할 수 있습니다.
    4. **단일 고장점 확인:** 선택한 NoSQL이 단일 고장점을 가지는지 확인하고, 필요하다면 복구 전략을 고려해야 합니다. 중요한 데이터의 손실을 방지하기 위한 대안을 마련해야 합니다.
    5. **원자성 지원 검토:** NoSQL이 제공하는 트랜잭션 지원 여부와 원자성을 확인합니다. 서버나 클라이언트에서 어떤 수준의 원자성이 보장되는지 판단합니다.
    6. **하드웨어 구성 및 아키텍처 확인:** NoSQL이 지원하는 하드웨어 구성과 아키텍처를 분석하여, 시스템의 가용성과 성능을 최적화할 수 있는지 판단합니다.
    7. **무중단 확장 가능성 평가:** 서비스 확장 시 중단 없이 수행 가능한지, 자동 샤딩 등의 기능을 통해 시스템을 확장할 수 있는지 고려합니다.

<br><br>

### Q. 문서 범위 검색(document range scan)을 할 때, 범위 내에 속한 문서 중 쓰기 작업(write operation)이 진행되고 있는 문서에는 쓰기 배타적 락(write exclusive lock)이 걸리면서 읽을 때 지연이 발생하는 경우 어떤 해결 방법이 있을 수 있을까?
- 문서들의 범위가 크면 클수록 락에 걸려 있는 대상이 많아질 것이므로 범위를 최소화하여 MongoDB에서 읽어오는 대상 문서의 범위를 축소할 수 있다.
- 기존 WAS에서 기타 조회에 대한 조건을 충족하는지 등의 필터링과 페이징 처리, 쿼리를 보다 구체화하여 MongoDB에서 읽어오는 대상 문서의 범위를 축소할 수 있다.
- 트래픽이 단기간에 들어오는 특정 상황의 경우 감지를 통해 쓰기 요청을 큐를 통해 지연 처리하는 형태로 대비할 수 있다.
- 문서 범위 스캔을 한다면 현재 클라이언트에서 사용하는 배치 크기가 각 서비스에 적합한지 확인한다. 배치 크기에 따라 MongoDB로 다녀오는 네트워크 라운드 트립(round trip) 수에 영향을 끼치고, 당연히 성능에도 직접적인 영향을 미친다.
(*배치 크기: MongoDB 클라이언트가 MongoDB로부터 한 번의 요청과 응답으로 전달받을 수 있는 문서의 최대 개수 의미)
- 참고) https://engineering.linecorp.com/ko/blog/LINE-integrated-notification-center-from-redis-to-mongodb

<br><br>

### Q. Redis 를 메인 스토리지로 사용하다가 가용량이 문제가 생겼을 경우 대처할 수 있는 방법들
- Redis 스케일아웃
- 리스타트를 통한 메모리 파편화 해소
- 데이터 압축(gzip)
- Redis의 sortedset 데이터 구조 변경(skiplist → ziplist)
- 만료된 데이터 주기적 삭제 처리

<br><br>

### Q. 채팅 시스템에서 적합한 데이터베이스는?
- if) 만약 Write-back 방식 (Redis caching + MySQL 저장) 을 선택한다면?
- if) NoSQL 중에서 어떤 데이터 모델이 가장 적합할까?
